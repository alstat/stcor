<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>stcor: Correlograms of Space-Time ARIMA by alstat</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>stcor: Correlograms of Space-Time ARIMA</h1>
        <p>r, arima, space-time, time series, package</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/alstat/stcor" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/alstat/stcor/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/alstat/stcor/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p>The <code>stcor</code> package provides functions for correlograms of the advanced time series model, the Space-Time Autoregressive Integrated Moving Average (STARIMA). These functions are the Space-Time Autocorrelation Function (<code>stacf</code>) and Space-Time Partial Autocorrelation Function (<code>stpacf</code>). Including function for centralizing (<code>stcenter</code>) the data to its mean.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>This package is not yet on CRAN, and still under development on <strong>github</strong>. Run the following for latest development:</p>

<div class="highlight highlight-coffee"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">require</span><span class="p">(</span><span class="s">"devtools"</span><span class="p">))</span>
  <span class="nx">install</span><span class="p">.</span><span class="nx">packages</span><span class="p">(</span><span class="s">"devtools"</span><span class="p">)</span>
<span class="nx">devtools</span><span class="o">::</span><span class="nx">install_github</span><span class="p">(</span><span class="s">"stcor"</span><span class="p">,</span> <span class="s">"alstat"</span><span class="p">)</span>
</pre></div>

<hr><h2>
<a name="vignette" class="anchor" href="#vignette"><span class="octicon octicon-link"></span></a>Vignette</h2>

<p>The package contains dataset named <code>palay</code> which is the volume of the rice production from the Cordillera Administrative Region (CAR) of the Philippines. Run <code>?palay</code> to get more details about the data. There are 6 regions in the dataset that can be assigned into the following weights matrices using the equal weighting of spatial order.</p>

<ul>
<li>First spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W1</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<ul>
<li>Second spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W2</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<ul>
<li>Third spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W3</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<p>It is required to centralize the data to its mean for STARIMA modeling, but before doing so, the Year column must be removed since we do not have to centralize this,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay1</span> <span class="o">&lt;-</span> <span class="nx">subset</span><span class="p">(</span><span class="nx">palay</span><span class="p">,</span> <span class="nv">select = </span><span class="o">-</span><span class="nx">c</span><span class="p">(</span><span class="nx">Year</span><span class="p">))</span>
</pre></div>

<p>Now, centralize the data</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span> <span class="o">&lt;-</span> <span class="nx">stcenter</span><span class="p">(</span><span class="nx">palay1</span><span class="p">)</span>
</pre></div>

<p>Finally, Compute the STACF and STPACF</p>

<div class="highlight highlight-coffee"><pre><span class="nx">stacf</span><span class="p">(</span><span class="nv">data = </span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4992931</span>    <span class="o">-</span><span class="mf">0.3768003</span>   <span class="mf">0.103059733</span>    <span class="mf">0.07686560</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>     <span class="mf">0.6379861</span>     <span class="mf">0.6286114</span>   <span class="mf">0.013944315</span>   <span class="o">-</span><span class="mf">0.02638101</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4907843</span>    <span class="o">-</span><span class="mf">0.3636884</span>   <span class="mf">0.046419684</span>    <span class="mf">0.07925981</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>     <span class="mf">0.9050261</span>     <span class="mf">0.5807629</span>   <span class="mf">0.019897096</span>    <span class="mf">0.09256568</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4804457</span>    <span class="o">-</span><span class="mf">0.3743855</span>   <span class="mf">0.094946729</span>    <span class="mf">0.06465131</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>     <span class="mf">0.5895664</span>     <span class="mf">0.5862548</span>   <span class="mf">0.007210034</span>   <span class="o">-</span><span class="mf">0.02778151</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4769501</span>    <span class="o">-</span><span class="mf">0.3559720</span>   <span class="mf">0.041717828</span>    <span class="mf">0.06999287</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>     <span class="mf">0.8321032</span>     <span class="mf">0.5432305</span>   <span class="mf">0.015287949</span>    <span class="mf">0.08079311</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4626080</span>    <span class="o">-</span><span class="mf">0.3692359</span>   <span class="mf">0.089099718</span>    <span class="mf">0.05182974</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>     <span class="mf">0.5400462</span>     <span class="mf">0.5396841</span>  <span class="o">-</span><span class="mf">0.001916337</span>   <span class="o">-</span><span class="mf">0.03069186</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4607559</span>    <span class="o">-</span><span class="mf">0.3461168</span>   <span class="mf">0.041789698</span>    <span class="mf">0.06116461</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>     <span class="mf">0.7589304</span>     <span class="mf">0.5078718</span>   <span class="mf">0.008028795</span>    <span class="mf">0.07026631</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4446532</span>    <span class="o">-</span><span class="mf">0.3634106</span>   <span class="mf">0.081175576</span>    <span class="mf">0.03902433</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>     <span class="mf">0.5030049</span>     <span class="mf">0.5120928</span>  <span class="o">-</span><span class="mf">0.003504128</span>   <span class="o">-</span><span class="mf">0.02963862</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4451392</span>    <span class="o">-</span><span class="mf">0.3396895</span>   <span class="mf">0.037675321</span>    <span class="mf">0.05017871</span>
</pre></div>

<div class="highlight highlight-coffee"><pre><span class="nx">stpacf</span><span class="p">(</span><span class="nv">data = </span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.14304647</span>   <span class="mf">0.511218868</span>    <span class="mf">0.55682738</span>    <span class="mf">0.19981610</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.25539678</span>   <span class="mf">0.473270591</span>    <span class="mf">0.14747855</span>    <span class="mf">0.10362970</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.10146576</span>   <span class="mf">0.359960022</span>   <span class="o">-</span><span class="mf">0.37010962</span>    <span class="mf">0.17611802</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>    <span class="mf">0.38601724</span>   <span class="mf">0.035951653</span>    <span class="mf">0.06345174</span>    <span class="mf">0.11231104</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.07615717</span>  <span class="o">-</span><span class="mf">0.209693181</span>   <span class="o">-</span><span class="mf">0.09118031</span>   <span class="o">-</span><span class="mf">0.01877791</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>    <span class="mf">0.25073879</span>  <span class="o">-</span><span class="mf">0.166778338</span>   <span class="o">-</span><span class="mf">0.03325437</span>   <span class="o">-</span><span class="mf">0.07793400</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>    <span class="mf">0.08483755</span>  <span class="o">-</span><span class="mf">0.096729707</span>   <span class="o">-</span><span class="mf">0.05191220</span>   <span class="o">-</span><span class="mf">0.10225812</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>    <span class="mf">0.20206063</span>   <span class="mf">0.005777546</span>   <span class="o">-</span><span class="mf">0.01424020</span>   <span class="o">-</span><span class="mf">0.03562691</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>    <span class="mf">0.14492995</span>  <span class="o">-</span><span class="mf">0.285797604</span>   <span class="o">-</span><span class="mf">0.09654800</span>   <span class="o">-</span><span class="mf">0.09723394</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>    <span class="mf">0.18184525</span>  <span class="o">-</span><span class="mf">0.576182623</span>   <span class="o">-</span><span class="mf">0.13934442</span>   <span class="o">-</span><span class="mf">0.16191452</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>    <span class="mf">0.15801674</span>  <span class="o">-</span><span class="mf">0.074907370</span>    <span class="mf">0.09285817</span>   <span class="o">-</span><span class="mf">0.01390365</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>    <span class="mf">0.22796914</span>  <span class="o">-</span><span class="mf">0.048807113</span>   <span class="o">-</span><span class="mf">0.09257688</span>   <span class="o">-</span><span class="mf">0.04854238</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>    <span class="mf">0.12255899</span>  <span class="o">-</span><span class="mf">0.130296912</span>   <span class="o">-</span><span class="mf">0.17546381</span>   <span class="o">-</span><span class="mf">0.10870668</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.05799165</span>   <span class="mf">0.313754236</span>    <span class="mf">0.06080497</span>    <span class="mf">0.07436464</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.09576009</span>  <span class="o">-</span><span class="mf">0.238561758</span>    <span class="mf">0.13853781</span>   <span class="o">-</span><span class="mf">0.06222810</span>
</pre></div>

<p>The findings suggest that the STACF is decaying spatially but not temporally, this is clearly due to the fact that the data is seasonal in nature. Hence, we need to take the first order seasonal differencing,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span> <span class="o">&lt;-</span> <span class="nx">diff</span><span class="p">(</span><span class="nx">as</span><span class="p">.</span><span class="nx">ts</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">),</span> <span class="nv">lag = </span><span class="mi">4</span><span class="p">)</span>
</pre></div>

<p><code>lag=4</code> since the data is quarterly; then we compute again the STACF and STPACF for the differenced series,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">stacf</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.102909427</span>   <span class="mf">0.025653689</span>   <span class="mf">0.082953522</span>  <span class="mf">0.0539520289</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>   <span class="mf">0.176881582</span>   <span class="mf">0.117139152</span>   <span class="mf">0.013167676</span>  <span class="mf">0.0115715456</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="mf">0.042544299</span>   <span class="mf">0.039321092</span>   <span class="mf">0.007792355</span>  <span class="mf">0.0554658845</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.175689995</span>   <span class="mf">0.033860939</span>   <span class="mf">0.007619782</span>  <span class="mf">0.0068130653</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>   <span class="mf">0.002817186</span>  <span class="o">-</span><span class="mf">0.028309614</span>  <span class="o">-</span><span class="mf">0.036774801</span>  <span class="mf">0.0259092901</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>   <span class="mf">0.075060958</span>   <span class="mf">0.088457609</span>   <span class="mf">0.034410303</span>  <span class="mf">0.0135122268</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>   <span class="mf">0.044036252</span>   <span class="mf">0.023091860</span>  <span class="o">-</span><span class="mf">0.024324734</span>  <span class="mf">0.0232175233</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>   <span class="mf">0.015816331</span>   <span class="mf">0.004172408</span>   <span class="mf">0.043260335</span> <span class="o">-</span><span class="mf">0.0127784432</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>   <span class="mf">0.030520792</span>   <span class="mf">0.013617616</span>   <span class="mf">0.028537045</span>  <span class="mf">0.0190366262</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.038435104</span>  <span class="o">-</span><span class="mf">0.120098561</span>  <span class="o">-</span><span class="mf">0.044183399</span> <span class="o">-</span><span class="mf">0.0241420075</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.008104361</span>   <span class="mf">0.061734994</span>   <span class="mf">0.053531660</span>  <span class="mf">0.0148140566</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>   <span class="mf">0.002133791</span>   <span class="mf">0.013137359</span>  <span class="o">-</span><span class="mf">0.054519301</span> <span class="o">-</span><span class="mf">0.0190006145</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>   <span class="mf">0.082231615</span>   <span class="mf">0.033276088</span>  <span class="o">-</span><span class="mf">0.005586549</span> <span class="o">-</span><span class="mf">0.0004980636</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.015698510</span>   <span class="mf">0.161005222</span>   <span class="mf">0.004396902</span>  <span class="mf">0.0289685701</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="mf">0.125114476</span>   <span class="mf">0.024381011</span>  <span class="o">-</span><span class="mf">0.010967296</span>  <span class="mf">0.0043345931</span>
</pre></div>

<div class="highlight highlight-coffee"><pre><span class="nx">stpacf</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.146421601</span>   <span class="mf">0.032487793</span>  <span class="mf">0.0853739625</span>   <span class="mf">0.088825947</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>   <span class="mf">0.227574617</span>   <span class="mf">0.265251476</span>  <span class="mf">0.0086875911</span>   <span class="mf">0.022379860</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="mf">0.013884996</span>   <span class="mf">0.234501046</span>  <span class="mf">0.0017332333</span>   <span class="mf">0.087121251</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.374341579</span>  <span class="o">-</span><span class="mf">0.007449137</span>  <span class="mf">0.0367435307</span>   <span class="mf">0.055216997</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.148779101</span>  <span class="o">-</span><span class="mf">0.137998111</span>  <span class="mf">0.0327572108</span>   <span class="mf">0.064802169</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>   <span class="mf">0.144623030</span>   <span class="mf">0.218952875</span> <span class="o">-</span><span class="mf">0.0008164024</span>   <span class="mf">0.030398092</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>   <span class="mf">0.093971255</span>   <span class="mf">0.287856390</span> <span class="o">-</span><span class="mf">0.0136972967</span>   <span class="mf">0.045549415</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.148459047</span>   <span class="mf">0.003528043</span>  <span class="mf">0.0666503281</span>  <span class="o">-</span><span class="mf">0.009344122</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.110767128</span>  <span class="o">-</span><span class="mf">0.218838986</span>  <span class="mf">0.0363238989</span>   <span class="mf">0.029674330</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.027504504</span>  <span class="o">-</span><span class="mf">0.071234693</span> <span class="o">-</span><span class="mf">0.0560620268</span>  <span class="o">-</span><span class="mf">0.020184495</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>   <span class="mf">0.041945574</span>   <span class="mf">0.265583483</span>  <span class="mf">0.0341692277</span>   <span class="mf">0.027824812</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.006097138</span>   <span class="mf">0.095614525</span>  <span class="mf">0.0095997826</span>  <span class="o">-</span><span class="mf">0.039610927</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>   <span class="mf">0.022523005</span>  <span class="o">-</span><span class="mf">0.100266088</span> <span class="o">-</span><span class="mf">0.0116048518</span>  <span class="o">-</span><span class="mf">0.008237559</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.094342410</span>   <span class="mf">0.199611218</span> <span class="o">-</span><span class="mf">0.0280317015</span>   <span class="mf">0.050161727</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="mf">0.066798455</span>   <span class="mf">0.139086023</span>  <span class="mf">0.0203601170</span>   <span class="mf">0.003121897</span>
</pre></div>

<p>The space-time ACF decays both in time and space; and the space-time PACF is significant in time lag 2 and cuts off at spatial lag 1. This is characterized by the space-time AR factor. Hence, we can consider our tentative model to be Seasonal STARIMA$(2_1,0,0)(0,1,0)_4$.</p>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/alstat">alstat</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>