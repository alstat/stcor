<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>stcor: Correlograms of Space-Time ARIMA by alstat</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>stcor: Correlograms of Space-Time ARIMA</h1>
        <p>r, arima, space-time, time series, package</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/alstat/stcor" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/alstat/stcor/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/alstat/stcor/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p>The <code>stcor</code> package provides functions for correlograms of the advanced time series model, the Space-Time Autoregressive Integrated Moving Average (STARIMA). These functions are the Space-Time Autocorrelation Function (<code>stacf</code>) and Space-Time Partial Autocorrelation Function (<code>stpacf</code>). Including function for centralizing (<code>stcenter</code>) the data to its mean.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<div class="highlight highlight-coffee"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">require</span><span class="p">(</span><span class="s">"devtools"</span><span class="p">))</span>
  <span class="nx">install</span><span class="p">.</span><span class="nx">packages</span><span class="p">(</span><span class="s">"devtools"</span><span class="p">)</span>
<span class="nx">devtools</span><span class="o">::</span><span class="nx">install_github</span><span class="p">(</span><span class="s">"stcor"</span><span class="p">,</span> <span class="s">"alstat"</span><span class="p">)</span>
</pre></div>

<hr><h2>
<a name="vignette" class="anchor" href="#vignette"><span class="octicon octicon-link"></span></a>Vignette</h2>

<p>The package contains dataset <code>palay</code> which is the volume of rice production from Cordillera Administrative Region (CAR) of the Philippines. run <code>?palay</code> to get more details on the data. The data has 6 regions that can be assigned into the following weights matrices using the equal weighting of spatial order.</p>

<ul>
<li>First spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W1</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<ul>
<li>Second spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W2</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<ul>
<li>Third spatial order weights matrix</li>
</ul><div class="highlight highlight-coffee"><pre><span class="nx">W3</span> <span class="o">&lt;-</span> <span class="nx">rbind</span><span class="p">(</span><span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="nx">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<p>It is required to centralize the data to its mean for STARIMA modeling, but before doing so, the Year column of the data must be removed since we do not have to centralize this,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay1</span> <span class="o">&lt;-</span> <span class="nx">subset</span><span class="p">(</span><span class="nx">palay</span><span class="p">,</span> <span class="nv">select = </span><span class="o">-</span><span class="nx">c</span><span class="p">(</span><span class="nx">Year</span><span class="p">))</span>
</pre></div>

<p>Now, centralize the data</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span> <span class="o">&lt;-</span> <span class="nx">stcenter</span><span class="p">(</span><span class="nx">palay1</span><span class="p">)</span>
</pre></div>

<p>Finally, Compute the STACF and STPACF</p>

<div class="highlight highlight-coffee"><pre><span class="nx">stacf</span><span class="p">(</span><span class="nv">data = </span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4992931</span>   <span class="o">-</span><span class="mf">0.06020914</span>    <span class="mf">0.04832691</span>    <span class="o">-</span><span class="mf">0.3430217</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>     <span class="mf">0.6379861</span>    <span class="mf">0.20788167</span>    <span class="mf">0.01852023</span>     <span class="mf">0.5425648</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4907843</span>   <span class="o">-</span><span class="mf">0.04705116</span>    <span class="mf">0.05408208</span>    <span class="o">-</span><span class="mf">0.3232515</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>     <span class="mf">0.9050261</span>    <span class="mf">0.22643810</span>    <span class="mf">0.09852541</span>     <span class="mf">0.5408789</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4804457</span>   <span class="o">-</span><span class="mf">0.06815819</span>    <span class="mf">0.03351860</span>    <span class="o">-</span><span class="mf">0.3393500</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>     <span class="mf">0.5895664</span>    <span class="mf">0.19035135</span>    <span class="mf">0.02051211</span>     <span class="mf">0.5013397</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4769501</span>   <span class="o">-</span><span class="mf">0.05071062</span>    <span class="mf">0.04101118</span>    <span class="o">-</span><span class="mf">0.3148463</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>     <span class="mf">0.8321032</span>    <span class="mf">0.20616214</span>    <span class="mf">0.09358343</span>     <span class="mf">0.5060509</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4626080</span>   <span class="o">-</span><span class="mf">0.07369541</span>    <span class="mf">0.01984861</span>    <span class="o">-</span><span class="mf">0.3334944</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>     <span class="mf">0.5400462</span>    <span class="mf">0.17108183</span>    <span class="mf">0.01750341</span>     <span class="mf">0.4589079</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4607559</span>   <span class="o">-</span><span class="mf">0.05103261</span>    <span class="mf">0.02807154</span>    <span class="o">-</span><span class="mf">0.3049772</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>     <span class="mf">0.7589304</span>    <span class="mf">0.18527446</span>    <span class="mf">0.08967877</span>     <span class="mf">0.4730669</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4446532</span>   <span class="o">-</span><span class="mf">0.08055303</span>    <span class="mf">0.00526782</span>    <span class="o">-</span><span class="mf">0.3257589</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>     <span class="mf">0.5030049</span>    <span class="mf">0.15949289</span>    <span class="mf">0.01989247</span>     <span class="mf">0.4360190</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>    <span class="o">-</span><span class="mf">0.4451392</span>   <span class="o">-</span><span class="mf">0.05345622</span>    <span class="mf">0.01595775</span>    <span class="o">-</span><span class="mf">0.3003420</span>
</pre></div>

<center>
  <img src = "http://ubuntuone.com/7R7qs0RBe5uTVbzl42TiNn" alt = "STACF">
</center>

<div class="highlight highlight-coffee"><pre><span class="nx">stpacf</span><span class="p">(</span><span class="nv">data = </span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.02823301</span>   <span class="mf">0.008987903</span>   <span class="mf">0.048705037</span>    <span class="mf">0.08933542</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mf">0.01063080</span>   <span class="mf">0.099286717</span>  <span class="o">-</span><span class="mf">0.051951462</span>    <span class="mf">0.17494632</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.14065728</span>   <span class="mf">0.351446318</span>   <span class="mf">0.276767636</span>    <span class="mf">0.23116367</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>    <span class="mf">0.68905497</span>   <span class="mf">0.034597797</span>  <span class="o">-</span><span class="mf">0.022866365</span>   <span class="o">-</span><span class="mf">0.06517905</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>    <span class="mf">0.05070857</span>  <span class="o">-</span><span class="mf">0.160956454</span>  <span class="o">-</span><span class="mf">0.185543857</span>   <span class="o">-</span><span class="mf">0.14180284</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>    <span class="mf">0.10431058</span>  <span class="o">-</span><span class="mf">0.096330383</span>   <span class="mf">0.052963877</span>   <span class="o">-</span><span class="mf">0.13878771</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>    <span class="mf">0.05835590</span>  <span class="o">-</span><span class="mf">0.177429701</span>  <span class="o">-</span><span class="mf">0.030925573</span>   <span class="o">-</span><span class="mf">0.07256701</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>    <span class="mf">0.25931172</span>  <span class="o">-</span><span class="mf">0.076016943</span>  <span class="o">-</span><span class="mf">0.051641416</span>   <span class="o">-</span><span class="mf">0.03489123</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>    <span class="mf">0.13415305</span>  <span class="o">-</span><span class="mf">0.006276763</span>  <span class="o">-</span><span class="mf">0.007680231</span>   <span class="o">-</span><span class="mf">0.06852715</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.03213706</span>  <span class="o">-</span><span class="mf">0.145538247</span>  <span class="o">-</span><span class="mf">0.076944680</span>   <span class="o">-</span><span class="mf">0.26853452</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>    <span class="mf">0.22032805</span>  <span class="o">-</span><span class="mf">0.134949490</span>  <span class="o">-</span><span class="mf">0.135539688</span>   <span class="o">-</span><span class="mf">0.06504067</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>    <span class="mf">0.07746315</span>  <span class="o">-</span><span class="mf">0.062477010</span>   <span class="mf">0.042674546</span>    <span class="mf">0.03834171</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.05131963</span>   <span class="mf">0.014992002</span>   <span class="mf">0.035750675</span>    <span class="mf">0.03530259</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>    <span class="mf">0.02187674</span>   <span class="mf">0.078717882</span>   <span class="mf">0.012064031</span>    <span class="mf">0.18609974</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="o">-</span><span class="mf">0.08605871</span>  <span class="o">-</span><span class="mf">0.071585168</span>  <span class="o">-</span><span class="mf">0.105247384</span>   <span class="o">-</span><span class="mf">0.13500443</span>
</pre></div>

<center>
  <img src = "http://ubuntuone.com/76vaf28tUczzbV8xdSrqlv" alt = "STPACF">
</center>


<p>Our findings is that, the STACF is not decaying both temporally and spatially, this is clearly due to the fact that the data is seasonal in nature. Hence, we need to take the first order seasonal differencing,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span> <span class="o">&lt;-</span> <span class="nx">diff</span><span class="p">(</span><span class="nx">as</span><span class="p">.</span><span class="nx">ts</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">cen</span><span class="p">),</span> <span class="nv">lag = </span><span class="mi">4</span><span class="p">)</span>
</pre></div>

<p>Then again, we compute the STACF and STPACF of the differenced series,</p>

<div class="highlight highlight-coffee"><pre><span class="nx">stacf</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.102909427</span>   <span class="mf">0.083636900</span>  <span class="mf">0.0403073854</span>   <span class="mf">0.038179694</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>   <span class="mf">0.176881582</span>   <span class="mf">0.019438667</span> <span class="o">-</span><span class="mf">0.0070691863</span>   <span class="mf">0.146269081</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="mf">0.042544299</span>   <span class="mf">0.042867035</span>  <span class="mf">0.0815154139</span>   <span class="mf">0.002562927</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.175689995</span>   <span class="mf">0.035204383</span>  <span class="mf">0.0024019208</span>   <span class="mf">0.019544634</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>   <span class="mf">0.002817186</span>  <span class="o">-</span><span class="mf">0.034520667</span>  <span class="mf">0.0113699136</span>  <span class="o">-</span><span class="mf">0.019744074</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>   <span class="mf">0.075060958</span>   <span class="mf">0.044314185</span>  <span class="mf">0.0235801562</span>   <span class="mf">0.042948623</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>   <span class="mf">0.044036252</span>  <span class="o">-</span><span class="mf">0.012706278</span>  <span class="mf">0.0246460998</span>   <span class="mf">0.030246641</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>   <span class="mf">0.015816331</span>   <span class="mf">0.011759783</span> <span class="o">-</span><span class="mf">0.0194888502</span>   <span class="mf">0.031732636</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>   <span class="mf">0.030520792</span>   <span class="mf">0.046711630</span>  <span class="mf">0.0225484166</span>  <span class="o">-</span><span class="mf">0.009435525</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.038435104</span>  <span class="o">-</span><span class="mf">0.044826092</span> <span class="o">-</span><span class="mf">0.0128675183</span>  <span class="o">-</span><span class="mf">0.114741210</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.008104361</span>   <span class="mf">0.038418438</span> <span class="o">-</span><span class="mf">0.0087326643</span>   <span class="mf">0.085432297</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>   <span class="mf">0.002133791</span>  <span class="o">-</span><span class="mf">0.027393319</span> <span class="o">-</span><span class="mf">0.0001690071</span>  <span class="o">-</span><span class="mf">0.018246899</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>   <span class="mf">0.082231615</span>  <span class="o">-</span><span class="mf">0.017085358</span>  <span class="mf">0.0152890404</span>   <span class="mf">0.044731970</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.015698510</span>   <span class="mf">0.060648279</span> <span class="o">-</span><span class="mf">0.0066032486</span>   <span class="mf">0.137841468</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="mf">0.125114476</span>   <span class="mf">0.006045925</span>  <span class="mf">0.0082689696</span>   <span class="mf">0.010564056</span>
</pre></div>

<center>
  <img src = "http://ubuntuone.com/3qUitIzaKm8yOQdpx0yzPn" alt = "Differenced STACF">
</center>

<div class="highlight highlight-coffee"><pre><span class="nx">stpacf</span><span class="p">(</span><span class="nx">palay</span><span class="p">.</span><span class="nx">dif</span><span class="p">,</span> <span class="nv">wmatrices = </span><span class="nx">list</span><span class="p">(</span><span class="nx">NULL</span><span class="p">,</span> <span class="nx">W1</span><span class="p">,</span> <span class="nx">W2</span><span class="p">,</span> <span class="nx">W3</span><span class="p">))</span>
</pre></div>

<div class="highlight highlight-coffee"><pre>      <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">0</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">1</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">2</span> <span class="nx">Spatial</span> <span class="nx">Lag</span> <span class="mi">3</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.150438290</span>   <span class="mf">0.130191183</span>  <span class="mf">0.0727639969</span>   <span class="mf">0.025040763</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>   <span class="mf">0.276100508</span>   <span class="mf">0.010840470</span> <span class="o">-</span><span class="mf">0.0107277062</span>   <span class="mf">0.218479601</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,]</span>   <span class="mf">0.071812816</span>   <span class="mf">0.043719906</span>  <span class="mf">0.0885910791</span>   <span class="mf">0.124437319</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.380765356</span>   <span class="mf">0.113546177</span>  <span class="mf">0.0569276624</span>  <span class="o">-</span><span class="mf">0.073881237</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.187336651</span>   <span class="mf">0.043035716</span>  <span class="mf">0.0185478999</span>  <span class="o">-</span><span class="mf">0.121974999</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,]</span>   <span class="mf">0.196875298</span>   <span class="mf">0.003145077</span> <span class="o">-</span><span class="mf">0.0073741193</span>   <span class="mf">0.122545952</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">,]</span>   <span class="mf">0.173496856</span>  <span class="o">-</span><span class="mf">0.021425821</span>  <span class="mf">0.0743013271</span>   <span class="mf">0.197169307</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.124770328</span>   <span class="mf">0.051807844</span>  <span class="mf">0.0101648418</span>  <span class="o">-</span><span class="mf">0.009699618</span>
 <span class="p">[</span><span class="mi">9</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.145140910</span>   <span class="mf">0.073959615</span>  <span class="mf">0.0111004890</span>  <span class="o">-</span><span class="mf">0.200308731</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.006878031</span>  <span class="o">-</span><span class="mf">0.048200948</span> <span class="o">-</span><span class="mf">0.0279187819</span>  <span class="o">-</span><span class="mf">0.095309571</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,]</span>   <span class="mf">0.111126109</span>   <span class="mf">0.012750419</span>  <span class="mf">0.0048213805</span>   <span class="mf">0.205577261</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,]</span>   <span class="mf">0.025174935</span>  <span class="o">-</span><span class="mf">0.030838635</span> <span class="o">-</span><span class="mf">0.0003660701</span>   <span class="mf">0.075341756</span>
<span class="p">[</span><span class="mi">13</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.013472644</span>  <span class="o">-</span><span class="mf">0.011832161</span>  <span class="mf">0.0302311014</span>  <span class="o">-</span><span class="mf">0.088961689</span>
<span class="p">[</span><span class="mi">14</span><span class="p">,]</span>  <span class="o">-</span><span class="mf">0.084545016</span>   <span class="mf">0.085280169</span> <span class="o">-</span><span class="mf">0.0197077865</span>   <span class="mf">0.058797824</span>
<span class="p">[</span><span class="mi">15</span><span class="p">,]</span>   <span class="mf">0.082998896</span>   <span class="mf">0.051000150</span>  <span class="mf">0.0088268281</span>   <span class="mf">0.068168052</span>
</pre></div>

<center>
  <img src = "http://ubuntuone.com/79QMt0JIa7TNHAIT3vszLp" alt = "Differenced STPACF">
</center>

<p>The findings suggest that the space-time ACF decays both in time and space; and the space-time PACF is significant in time lag 2 and 4, at spatial lag 0. Our tentative model therefore, would either be Seasonal STARIMA(2_0,0,0)(0,1,0)<em>4 or Seasonal STARIMA(4</em>0,0,0)(0,1,0)_4.</p>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/alstat">Al-Ahmadgaid Asaad</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
