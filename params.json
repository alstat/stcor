{"name":"stcor: Correlograms of Space-Time ARIMA","tagline":"r, arima, space-time, time series, package","body":"Description\r\n=====\r\nThe `stcor` package provides functions for correlograms of the advanced time series model, the Space-Time Autoregressive Integrated Moving Average (STARIMA). These functions are the Space-Time Autocorrelation Function (`stacf`) and Space-Time Partial Autocorrelation Function (`stpacf`). Including function for centralizing (`stcenter`) the data to its mean.\r\n\r\nInstallation\r\n-----\r\n```{coffee}\r\nif (!require(\"devtools\"))\r\n  install.packages(\"devtools\")\r\ndevtools::install_github(\"stcor\", \"alstat\")\r\n```\r\n\r\n***\r\nVignette\r\n-----\r\nThe package contains dataset `palay` which is the volume of rice production from Cordillera Administrative Region (CAR) of the Philippines. run `?palay` to get more details on the data. The data has 6 regions that can be assigned into the following weights matrices using the equal weighting of spatial order.\r\n\r\n* First spatial order weights matrix\r\n\r\n```{coffee}\r\nW1 <- rbind(c(0, 1/2, 1/2, 0, 0, 0),\r\n            c(1/2, 0, 1/2, 0, 0, 0),\r\n            c(1/3, 1/3, 0, 1/3, 0, 0),\r\n            c(0, 0, 1/2, 0, 1/2, 0),\r\n            c(0, 0, 0, 1/2, 0, 1/2),\r\n            c(0, 0, 0, 1/2, 1/2, 0))\r\n```\r\n\r\n* Second spatial order weights matrix\r\n\r\n```{coffee}\r\nW2 <- rbind(c(0, 0, 0, 1, 0, 0),\r\n            c(0, 0, 0, 1, 0, 0),\r\n            c(0, 0, 0, 0, 1, 0),\r\n            c(0, 0, 0, 0, 0, 1),\r\n            c(0, 0, 1, 0, 0, 0),\r\n            c(0, 0, 1, 0, 0, 0))\r\n```\r\n\r\n* Third spatial order weights matrix\r\n\r\n```{coffee}\r\nW3 <- rbind(c(0, 0, 0, 0, 1, 0),\r\n            c(0, 0, 0, 0, 1/2, 1/2),\r\n            c(0, 0, 0, 0, 0, 1),\r\n            c(1, 0, 0, 0, 0, 0),\r\n            c(1/2, 1/2, 0, 0, 0, 0),\r\n            c(0, 1, 0, 0, 0, 0))\r\n```\r\n\r\nIt is required to centralize the data to its mean for STARIMA modeling, but before doing so, the Year column of the data must be removed since we do not have to centralize this,\r\n```{coffee}\r\npalay1 <- subset(palay, select = -c(Year))\r\n```\r\n\r\nNow, centralize the data\r\n```{coffee}\r\npalay.cen <- stcenter(palay1)\r\n```\r\n\r\nFinally, Compute the STACF and STPACF\r\n```{coffee}\r\nstacf(data = palay.cen, wmatrices = list(NULL, W1, W2, W3))\r\n```\r\n\r\n```{coffee}\r\n      Spatial Lag 0 Spatial Lag 1 Spatial Lag 2 Spatial Lag 3\r\n [1,]    -0.4992931   -0.06020914    0.04832691    -0.3430217\r\n [2,]     0.6379861    0.20788167    0.01852023     0.5425648\r\n [3,]    -0.4907843   -0.04705116    0.05408208    -0.3232515\r\n [4,]     0.9050261    0.22643810    0.09852541     0.5408789\r\n [5,]    -0.4804457   -0.06815819    0.03351860    -0.3393500\r\n [6,]     0.5895664    0.19035135    0.02051211     0.5013397\r\n [7,]    -0.4769501   -0.05071062    0.04101118    -0.3148463\r\n [8,]     0.8321032    0.20616214    0.09358343     0.5060509\r\n [9,]    -0.4626080   -0.07369541    0.01984861    -0.3334944\r\n[10,]     0.5400462    0.17108183    0.01750341     0.4589079\r\n[11,]    -0.4607559   -0.05103261    0.02807154    -0.3049772\r\n[12,]     0.7589304    0.18527446    0.08967877     0.4730669\r\n[13,]    -0.4446532   -0.08055303    0.00526782    -0.3257589\r\n[14,]     0.5030049    0.15949289    0.01989247     0.4360190\r\n[15,]    -0.4451392   -0.05345622    0.01595775    -0.3003420\r\n```\r\n\r\n```{coffee}\r\nstpacf(data = palay.cen, wmatrices = list(NULL, W1, W2, W3))\r\n```\r\n\r\n```{coffee}\r\n      Spatial Lag 0 Spatial Lag 1 Spatial Lag 2 Spatial Lag 3\r\n [1,]   -0.02823301   0.008987903   0.048705037    0.08933542\r\n [2,]    0.01063080   0.099286717  -0.051951462    0.17494632\r\n [3,]   -0.14065728   0.351446318   0.276767636    0.23116367\r\n [4,]    0.68905497   0.034597797  -0.022866365   -0.06517905\r\n [5,]    0.05070857  -0.160956454  -0.185543857   -0.14180284\r\n [6,]    0.10431058  -0.096330383   0.052963877   -0.13878771\r\n [7,]    0.05835590  -0.177429701  -0.030925573   -0.07256701\r\n [8,]    0.25931172  -0.076016943  -0.051641416   -0.03489123\r\n [9,]    0.13415305  -0.006276763  -0.007680231   -0.06852715\r\n[10,]   -0.03213706  -0.145538247  -0.076944680   -0.26853452\r\n[11,]    0.22032805  -0.134949490  -0.135539688   -0.06504067\r\n[12,]    0.07746315  -0.062477010   0.042674546    0.03834171\r\n[13,]   -0.05131963   0.014992002   0.035750675    0.03530259\r\n[14,]    0.02187674   0.078717882   0.012064031    0.18609974\r\n[15,]   -0.08605871  -0.071585168  -0.105247384   -0.13500443\r\n```\r\nOur findings is that, the STACF is not decaying both temporally and spatially, this is clearly due to the fact that the data is seasonal in nature. Hence, we need to take the first order seasonal differencing,\r\n```{coffee}\r\npalay.dif <- diff(as.ts(palay.cen), lag = 4)\r\n```\r\nThen again, we compute the STACF and STPACF of the differenced series,\r\n```{coffee}\r\nstacf(palay.dif, wmatrices = list(NULL, W1, W2, W3))\r\n```\r\n\r\n```{coffee}\r\n      Spatial Lag 0 Spatial Lag 1 Spatial Lag 2 Spatial Lag 3\r\n [1,]  -0.102909427   0.083636900  0.0403073854   0.038179694\r\n [2,]   0.176881582   0.019438667 -0.0070691863   0.146269081\r\n [3,]   0.042544299   0.042867035  0.0815154139   0.002562927\r\n [4,]  -0.175689995   0.035204383  0.0024019208   0.019544634\r\n [5,]   0.002817186  -0.034520667  0.0113699136  -0.019744074\r\n [6,]   0.075060958   0.044314185  0.0235801562   0.042948623\r\n [7,]   0.044036252  -0.012706278  0.0246460998   0.030246641\r\n [8,]   0.015816331   0.011759783 -0.0194888502   0.031732636\r\n [9,]   0.030520792   0.046711630  0.0225484166  -0.009435525\r\n[10,]  -0.038435104  -0.044826092 -0.0128675183  -0.114741210\r\n[11,]  -0.008104361   0.038418438 -0.0087326643   0.085432297\r\n[12,]   0.002133791  -0.027393319 -0.0001690071  -0.018246899\r\n[13,]   0.082231615  -0.017085358  0.0152890404   0.044731970\r\n[14,]  -0.015698510   0.060648279 -0.0066032486   0.137841468\r\n[15,]   0.125114476   0.006045925  0.0082689696   0.010564056\r\n```\r\n\r\n```{coffee}\r\nstpacf(palay.dif, wmatrices = list(NULL, W1, W2, W3))\r\n```\r\n\r\n```{coffee}\r\n      Spatial Lag 0 Spatial Lag 1 Spatial Lag 2 Spatial Lag 3\r\n [1,]  -0.150438290   0.130191183  0.0727639969   0.025040763\r\n [2,]   0.276100508   0.010840470 -0.0107277062   0.218479601\r\n [3,]   0.071812816   0.043719906  0.0885910791   0.124437319\r\n [4,]  -0.380765356   0.113546177  0.0569276624  -0.073881237\r\n [5,]  -0.187336651   0.043035716  0.0185478999  -0.121974999\r\n [6,]   0.196875298   0.003145077 -0.0073741193   0.122545952\r\n [7,]   0.173496856  -0.021425821  0.0743013271   0.197169307\r\n [8,]  -0.124770328   0.051807844  0.0101648418  -0.009699618\r\n [9,]  -0.145140910   0.073959615  0.0111004890  -0.200308731\r\n[10,]  -0.006878031  -0.048200948 -0.0279187819  -0.095309571\r\n[11,]   0.111126109   0.012750419  0.0048213805   0.205577261\r\n[12,]   0.025174935  -0.030838635 -0.0003660701   0.075341756\r\n[13,]  -0.013472644  -0.011832161  0.0302311014  -0.088961689\r\n[14,]  -0.084545016   0.085280169 -0.0197077865   0.058797824\r\n[15,]   0.082998896   0.051000150  0.0088268281   0.068168052\r\n```\r\n\r\nThe findings suggest that the space-time ACF decays both in time and space; and the space-time PACF is significant in time lag 2 and 4, at spatial lag 0. Our tentative model therefore, would either be Seasonal STARIMA(2_0,0,0)(0,1,0)_4 or Seasonal STARIMA(4_0,0,0)(0,1,0)_4.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}